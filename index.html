<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¹„íŒì  ì‚¬ê³  ì—°ìŠµê¸° - ì •ë³´ì˜ ë°”ë‹¤ì—ì„œ ê´€ì  ì„¸ìš°ê¸°</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap');
        *{margin:0;padding:0;box-sizing:border-box}

        body{
            font-family:'Noto Sans KR',sans-serif;
            background:#0b0e1a;
            min-height:100vh;
            color:#fff;
            overflow-x:hidden;
        }

        /* ===== ANIMATED BG ===== */
        .bg-glow{
            position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden;
        }
        .bg-glow .orb{
            position:absolute;border-radius:50%;filter:blur(80px);opacity:.35;
            animation:float 12s ease-in-out infinite;
        }
        .bg-glow .orb:nth-child(1){
            width:420px;height:420px;
            background:radial-gradient(circle,#4ecdc4,transparent 70%);
            top:-10%;left:-5%;animation-duration:14s;
        }
        .bg-glow .orb:nth-child(2){
            width:350px;height:350px;
            background:radial-gradient(circle,#6c63ff,transparent 70%);
            bottom:-8%;right:-5%;animation-duration:18s;animation-delay:-4s;
        }
        .bg-glow .orb:nth-child(3){
            width:250px;height:250px;
            background:radial-gradient(circle,#ff6b9d,transparent 70%);
            top:40%;left:60%;animation-duration:16s;animation-delay:-8s;opacity:.2;
        }
        @keyframes float{
            0%,100%{transform:translate(0,0) scale(1)}
            33%{transform:translate(30px,-40px) scale(1.05)}
            66%{transform:translate(-20px,30px) scale(.95)}
        }

        .page-wrap{position:relative;z-index:1;}

        /* ===== HEADER ===== */
        .header{
            text-align:center;
            padding:56px 20px 36px;
        }
        .header-tag{
            display:inline-flex;align-items:center;gap:6px;
            color:#4ecdc4;font-size:12px;letter-spacing:3px;font-weight:500;
            background:rgba(78,205,196,.08);
            border:1px solid rgba(78,205,196,.2);
            padding:8px 20px;border-radius:24px;margin-bottom:24px;
            backdrop-filter:blur(10px);
        }
        .header-tag::before{content:'';display:block;width:6px;height:6px;background:#4ecdc4;border-radius:50%;animation:blink 2s ease-in-out infinite;}
        @keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}

        .header h1{
            font-size:2.6rem;font-weight:900;line-height:1.35;margin-bottom:16px;
            background:linear-gradient(135deg,#fff 0%,#4ecdc4 50%,#6c63ff 100%);
            background-size:200% 200%;
            -webkit-background-clip:text;-webkit-text-fill-color:transparent;
            background-clip:text;
            animation:gradShift 6s ease-in-out infinite;
        }
        @keyframes gradShift{0%,100%{background-position:0% 50%}50%{background-position:100% 50%}}

        .header .desc{
            color:#7a8599;font-size:15px;max-width:480px;margin:0 auto;line-height:1.8;
        }

        .container{max-width:920px;margin:0 auto;padding:0 20px 80px;}

        /* ===== STEP INDICATOR ===== */
        .steps{
            display:flex;justify-content:center;gap:12px;margin-bottom:36px;
        }
        .step{
            display:flex;align-items:center;gap:8px;
            padding:8px 18px;border-radius:24px;font-size:13px;font-weight:600;
            background:rgba(255,255,255,.04);
            border:1px solid rgba(255,255,255,.06);
            color:#556;transition:all .4s;
        }
        .step .num{
            width:22px;height:22px;border-radius:50%;
            display:flex;align-items:center;justify-content:center;
            font-size:11px;font-weight:700;
            background:rgba(255,255,255,.08);color:#556;
            transition:all .4s;
        }
        .step.active{
            background:rgba(78,205,196,.1);border-color:rgba(78,205,196,.3);color:#4ecdc4;
        }
        .step.active .num{background:#4ecdc4;color:#0b0e1a;}
        .step.done{color:#4ecdc4;opacity:.6;}
        .step.done .num{background:#4ecdc4;color:#0b0e1a;}

        /* ===== GLASS CARD BASE ===== */
        .glass{
            background:rgba(255,255,255,.03);
            backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);
            border:1px solid rgba(255,255,255,.07);
            border-radius:24px;
        }

        /* ===== INPUT SECTION ===== */
        .input-section{
            padding:40px;margin-bottom:32px;
            position:relative;overflow:hidden;
        }
        .input-section::before{
            content:'';position:absolute;top:0;left:0;right:0;height:3px;
            background:linear-gradient(90deg,#4ecdc4,#6c63ff,#ff6b9d);
            border-radius:24px 24px 0 0;
        }
        .input-label{
            display:flex;align-items:center;gap:12px;
            margin-bottom:8px;font-weight:700;font-size:18px;
        }
        .input-label .icon{
            width:40px;height:40px;
            background:linear-gradient(135deg,rgba(78,205,196,.2),rgba(108,99,255,.2));
            border-radius:12px;
            display:flex;align-items:center;justify-content:center;
            font-size:20px;
        }
        .input-hint{color:#6a7389;font-size:13px;margin-bottom:18px;line-height:1.6;margin-left:52px;}

        textarea{
            width:100%;min-height:140px;
            background:rgba(0,0,0,.3);
            border:1px solid rgba(255,255,255,.08);
            border-radius:16px;padding:20px;
            color:#e0e6f0;
            font-family:'Noto Sans KR',sans-serif;font-size:15px;line-height:1.8;
            resize:vertical;transition:all .3s;
        }
        textarea:focus{outline:none;border-color:rgba(78,205,196,.5);box-shadow:0 0 0 3px rgba(78,205,196,.1);}
        textarea::placeholder{color:#3a4255;}

        /* ===== EXAMPLE CHIPS ===== */
        .examples{display:flex;flex-wrap:wrap;gap:10px;margin-top:16px;}
        .example-chip{
            background:rgba(78,205,196,.06);
            border:1px solid rgba(78,205,196,.15);
            color:#4ecdc4;padding:8px 18px;border-radius:24px;
            font-size:13px;cursor:pointer;transition:all .3s;
            position:relative;overflow:hidden;
        }
        .example-chip::before{
            content:'';position:absolute;inset:0;
            background:linear-gradient(135deg,rgba(78,205,196,.15),transparent);
            opacity:0;transition:opacity .3s;
        }
        .example-chip:hover{
            border-color:rgba(78,205,196,.5);transform:translateY(-1px);
            box-shadow:0 4px 12px rgba(78,205,196,.15);
        }
        .example-chip:hover::before{opacity:1;}

        /* ===== SUBMIT BUTTON ===== */
        .submit-area{text-align:center;margin-bottom:40px;}
        .submit-btn{
            position:relative;
            background:linear-gradient(135deg,#4ecdc4,#44a08d);
            border:none;color:#0b0e1a;
            padding:18px 56px;border-radius:16px;
            font-size:17px;font-weight:700;
            cursor:pointer;transition:all .3s;
            font-family:'Noto Sans KR',sans-serif;
            overflow:hidden;
        }
        .submit-btn::before{
            content:'';position:absolute;inset:-2px;
            background:linear-gradient(135deg,#4ecdc4,#6c63ff,#ff6b9d,#4ecdc4);
            background-size:300% 300%;
            border-radius:18px;z-index:-1;
            animation:borderGlow 4s ease-in-out infinite;
            filter:blur(8px);opacity:.6;
        }
        @keyframes borderGlow{0%,100%{background-position:0% 50%}50%{background-position:100% 50%}}
        .submit-btn:hover{
            transform:translateY(-3px);
            box-shadow:0 8px 32px rgba(78,205,196,.4);
        }
        .submit-btn:disabled{opacity:.4;cursor:not-allowed;transform:none;}
        .submit-btn:disabled::before{opacity:0;}

        /* ===== LOADING ===== */
        .loading{display:none;text-align:center;padding:80px 20px;}
        .loading.show{display:block;}
        .loading-brain{
            width:72px;height:72px;margin:0 auto 24px;
            position:relative;
        }
        .loading-brain .ring{
            position:absolute;inset:0;
            border:3px solid transparent;
            border-radius:50%;
        }
        .loading-brain .ring:nth-child(1){
            border-top-color:#4ecdc4;animation:spin 1s linear infinite;
        }
        .loading-brain .ring:nth-child(2){
            inset:8px;border-right-color:#6c63ff;animation:spin 1.5s linear infinite reverse;
        }
        .loading-brain .ring:nth-child(3){
            inset:16px;border-bottom-color:#ff6b9d;animation:spin 2s linear infinite;
        }
        .loading-brain .core{
            position:absolute;inset:24px;
            background:radial-gradient(circle,rgba(78,205,196,.3),transparent);
            border-radius:50%;animation:pulse 1.5s ease-in-out infinite;
        }
        @keyframes spin{to{transform:rotate(360deg)}}
        @keyframes pulse{0%,100%{transform:scale(.8);opacity:.5}50%{transform:scale(1.1);opacity:1}}

        .loading-text{color:#7a8599;font-size:15px;}
        .loading-steps{
            display:flex;justify-content:center;gap:24px;margin-top:20px;
        }
        .loading-step{
            font-size:12px;color:#445;font-weight:500;
            display:flex;align-items:center;gap:6px;
            transition:color .3s;
        }
        .loading-step.active{color:#4ecdc4;}
        .loading-step .dot{
            width:8px;height:8px;border-radius:50%;
            background:#334;transition:background .3s;
        }
        .loading-step.active .dot{background:#4ecdc4;box-shadow:0 0 8px #4ecdc4;}

        /* ===== RESULT SECTION ===== */
        .result-section{display:none;}
        .result-section.show{display:block;animation:fadeUp .6s ease both;}
        @keyframes fadeUp{from{opacity:0;transform:translateY(40px)}to{opacity:1;transform:translateY(0)}}

        /* ===== INPUT ECHO ===== */
        .input-echo{
            position:relative;
            background:rgba(78,205,196,.04);
            border:1px solid rgba(78,205,196,.12);
            border-radius:20px;
            padding:24px 28px;margin-bottom:36px;
            overflow:hidden;
        }
        .input-echo::before{
            content:'';position:absolute;left:0;top:0;bottom:0;width:4px;
            background:linear-gradient(180deg,#4ecdc4,#6c63ff);
            border-radius:20px 0 0 20px;
        }
        .input-echo-label{
            color:#4ecdc4;font-size:11px;font-weight:700;letter-spacing:2px;
            margin-bottom:10px;text-transform:uppercase;
        }
        .input-echo-text{color:#c8d0e0;font-size:16px;line-height:1.7;font-weight:500;}

        /* ===== 4 ELEMENT CARDS ===== */
        .elements-grid{
            display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:36px;
        }

        .element-card{
            position:relative;
            background:rgba(255,255,255,.03);
            backdrop-filter:blur(10px);
            border:1px solid rgba(255,255,255,.06);
            border-radius:22px;padding:30px;
            transition:all .5s cubic-bezier(.23,1,.32,1);
            opacity:0;transform:translateY(30px);
            overflow:hidden;
        }
        .element-card::before{
            content:'';position:absolute;top:0;left:0;right:0;height:2px;
            opacity:0;transition:opacity .4s;
        }
        .element-card:nth-child(1)::before{background:linear-gradient(90deg,#4ecdc4,#44a08d);}
        .element-card:nth-child(2)::before{background:linear-gradient(90deg,#6c63ff,#a78bfa);}
        .element-card:nth-child(3)::before{background:linear-gradient(90deg,#ff6b9d,#ffa07a);}
        .element-card:nth-child(4)::before{background:linear-gradient(90deg,#ffc107,#ffeb3b);}

        .element-card.visible{opacity:1;transform:translateY(0);}
        .element-card:hover{
            border-color:rgba(255,255,255,.12);
            transform:translateY(-4px);
            box-shadow:0 12px 40px rgba(0,0,0,.3);
        }
        .element-card:hover::before{opacity:1;}

        .element-header{
            display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;
        }
        .element-title{display:flex;align-items:center;gap:10px;}
        .element-icon{
            width:40px;height:40px;border-radius:12px;
            display:flex;align-items:center;justify-content:center;
            font-size:20px;
        }
        .element-card:nth-child(1) .element-icon{background:rgba(78,205,196,.12);}
        .element-card:nth-child(2) .element-icon{background:rgba(108,99,255,.12);}
        .element-card:nth-child(3) .element-icon{background:rgba(255,107,157,.12);}
        .element-card:nth-child(4) .element-icon{background:rgba(255,193,7,.12);}

        .element-name{font-weight:700;font-size:16px;}
        .element-card:nth-child(1) .element-name{color:#4ecdc4;}
        .element-card:nth-child(2) .element-name{color:#a78bfa;}
        .element-card:nth-child(3) .element-name{color:#ff6b9d;}
        .element-card:nth-child(4) .element-name{color:#ffc107;}

        .element-number{
            font-size:11px;font-weight:700;letter-spacing:1px;
            color:rgba(255,255,255,.15);
        }

        .element-question{
            font-size:13px;font-style:italic;
            margin-bottom:16px;padding:10px 14px;
            border-radius:10px;line-height:1.6;
        }
        .element-card:nth-child(1) .element-question{color:#4ecdc4;background:rgba(78,205,196,.06);}
        .element-card:nth-child(2) .element-question{color:#a78bfa;background:rgba(108,99,255,.06);}
        .element-card:nth-child(3) .element-question{color:#ff6b9d;background:rgba(255,107,157,.06);}
        .element-card:nth-child(4) .element-question{color:#ffc107;background:rgba(255,193,7,.06);}

        .element-content{color:#b0b8cc;font-size:14px;line-height:1.9;}

        /* ===== PERSPECTIVE BOX ===== */
        .perspective-box{
            position:relative;
            border-radius:22px;padding:40px 36px;
            text-align:center;margin-bottom:40px;
            background:rgba(78,205,196,.05);
            overflow:hidden;
        }
        .perspective-box::before{
            content:'';position:absolute;inset:-2px;
            background:linear-gradient(135deg,#4ecdc4,#6c63ff,#ff6b9d,#4ecdc4);
            background-size:300% 300%;
            border-radius:24px;z-index:-1;
            animation:borderGlow 4s ease-in-out infinite;
        }
        .perspective-box::after{
            content:'';position:absolute;inset:2px;
            background:#0d1120;border-radius:20px;z-index:-1;
        }
        .perspective-icon{font-size:32px;margin-bottom:12px;}
        .perspective-label{
            color:#4ecdc4;font-size:12px;font-weight:700;
            letter-spacing:3px;margin-bottom:18px;text-transform:uppercase;
        }
        .perspective-text{
            font-size:21px;font-weight:700;line-height:1.65;
            background:linear-gradient(135deg,#fff,#4ecdc4);
            -webkit-background-clip:text;-webkit-text-fill-color:transparent;
            background-clip:text;
        }

        /* ===== ACTION BUTTONS ===== */
        .action-area{display:flex;justify-content:center;gap:16px;flex-wrap:wrap;}
        .retry-btn{
            background:rgba(255,255,255,.04);
            border:1px solid rgba(255,255,255,.1);
            color:#b0b8cc;padding:15px 36px;border-radius:14px;
            font-size:15px;font-weight:600;cursor:pointer;
            transition:all .3s;font-family:'Noto Sans KR',sans-serif;
            backdrop-filter:blur(10px);
        }
        .retry-btn:hover{
            border-color:rgba(78,205,196,.4);color:#4ecdc4;
            background:rgba(78,205,196,.08);
        }
        .new-btn{
            background:linear-gradient(135deg,#4ecdc4,#44a08d);
            border:none;color:#0b0e1a;padding:15px 36px;border-radius:14px;
            font-size:15px;font-weight:700;cursor:pointer;
            transition:all .3s;font-family:'Noto Sans KR',sans-serif;
        }
        .new-btn:hover{
            transform:translateY(-2px);
            box-shadow:0 6px 24px rgba(78,205,196,.35);
        }

        /* ===== ERROR ===== */
        .error-msg{
            display:none;
            background:rgba(255,107,107,.08);
            border:1px solid rgba(255,107,107,.25);
            border-radius:16px;padding:16px 24px;
            color:#ff6b6b;text-align:center;
            margin-bottom:20px;font-size:14px;
            backdrop-filter:blur(10px);
        }
        .error-msg.show{display:block;animation:shake .4s ease;}
        @keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-6px)}75%{transform:translateX(6px)}}

        /* ===== FOOTER ===== */
        footer{
            text-align:center;padding:40px 20px;
            color:#2a3040;font-size:12px;line-height:2;
        }
        footer span{color:#4ecdc4;opacity:.4;}

        /* ===== RESPONSIVE ===== */
        @media(max-width:700px){
            .header h1{font-size:1.8rem;}
            .elements-grid{grid-template-columns:1fr;}
            .input-section{padding:28px;}
            .perspective-text{font-size:17px;}
            .steps{flex-wrap:wrap;}
            .step span{display:none;}
            .loading-steps{flex-wrap:wrap;gap:12px;}
        }
    </style>
</head>
<body>

    <!-- Animated Background -->
    <div class="bg-glow">
        <div class="orb"></div>
        <div class="orb"></div>
        <div class="orb"></div>
    </div>

    <div class="page-wrap">
        <!-- HEADER -->
        <div class="header">
            <div class="header-tag">AI ì‹œëŒ€ ë¯¸ë˜ ì—­ëŸ‰ [ì œ 2ê°•]</div>
            <h1>ë¹„íŒì  ì‚¬ê³  ì—°ìŠµê¸°</h1>
            <p class="desc">ì •ë³´ë‚˜ ìƒí™©ì„ ì…ë ¥í•˜ë©´, AIê°€ ë¹„íŒì  ì‚¬ê³ ì˜ 4ëŒ€ ìš”ì†Œë¡œ<br>ë¶„ì„í•˜ì—¬ ê´€ì  ì„¸ìš°ê¸°ë¥¼ ë„ì™€ë“œë¦½ë‹ˆë‹¤.</p>
        </div>

        <div class="container">
            <!-- STEP INDICATOR -->
            <div class="steps" id="steps">
                <div class="step active" data-step="1"><div class="num">1</div><span>ì •ë³´ ì…ë ¥</span></div>
                <div class="step" data-step="2"><div class="num">2</div><span>AI ë¶„ì„</span></div>
                <div class="step" data-step="3"><div class="num">3</div><span>ê´€ì  ë„ì¶œ</span></div>
            </div>

            <!-- INPUT SECTION -->
            <div class="input-section glass" id="inputSection">
                <div class="input-label">
                    <div class="icon">ğŸ’¡</div>
                    <span>ë¶„ì„í•  ì •ë³´ ë˜ëŠ” ìƒí™© ì…ë ¥</span>
                </div>
                <div class="input-hint">ë‰´ìŠ¤ ê¸°ì‚¬, SNS ê²Œì‹œê¸€, ëˆ„êµ°ê°€ì˜ ì£¼ì¥, ë˜ëŠ” ê³ ë¯¼ë˜ëŠ” ìƒí™©ì„ ììœ ë¡­ê²Œ ì…ë ¥í•˜ì„¸ìš”.</div>
                <textarea id="userInput" placeholder="ì˜ˆ: &quot;SNS ì† ì‚¬ëŒë“¤ì€ ëª¨ë‘ í–‰ë³µí•´ ë³´ì—¬. ë‚˜ë§Œ ë’¤ì²˜ì§€ê³  ë¶ˆí–‰í•œ ê²ƒ ê°™ì•„.&quot;"></textarea>
                <div class="examples">
                    <div class="example-chip" onclick="setExample(this)">SNS ì† ëª¨ë‘ê°€ í–‰ë³µí•´ ë³´ì¸ë‹¤</div>
                    <div class="example-chip" onclick="setExample(this)">ëª…ë¬¸ëŒ€ë¥¼ ê°€ì•¼ ì„±ê³µí•œë‹¤</div>
                    <div class="example-chip" onclick="setExample(this)">AIê°€ ëª¨ë“  ì§ì—…ì„ ëŒ€ì²´í•  ê²ƒì´ë‹¤</div>
                    <div class="example-chip" onclick="setExample(this)">ì½”ë”© êµìœ¡ì€ í•„ìˆ˜ë‹¤</div>
                </div>
            </div>

            <!-- ERROR -->
            <div class="error-msg" id="errorMsg"></div>

            <!-- SUBMIT -->
            <div class="submit-area" id="submitArea">
                <button class="submit-btn" id="submitBtn" onclick="analyze()">ë¹„íŒì  ì‚¬ê³ ë¡œ ë¶„ì„í•˜ê¸°</button>
            </div>

            <!-- LOADING -->
            <div class="loading" id="loading">
                <div class="loading-brain">
                    <div class="ring"></div>
                    <div class="ring"></div>
                    <div class="ring"></div>
                    <div class="core"></div>
                </div>
                <p class="loading-text">AIê°€ ë¹„íŒì  ì‚¬ê³ ë¡œ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...</p>
                <div class="loading-steps" id="loadingSteps">
                    <div class="loading-step active" data-ls="1"><div class="dot"></div>ë¶„ì„</div>
                    <div class="loading-step" data-ls="2"><div class="dot"></div>í‰ê°€</div>
                    <div class="loading-step" data-ls="3"><div class="dot"></div>ì¶”ë¡ </div>
                    <div class="loading-step" data-ls="4"><div class="dot"></div>ì„±ì°°</div>
                </div>
            </div>

            <!-- RESULT -->
            <div class="result-section" id="resultSection">
                <div class="input-echo">
                    <div class="input-echo-label">INPUT / ì •ë³´ ìœ ì…</div>
                    <div class="input-echo-text" id="echoText"></div>
                </div>
                <div class="elements-grid" id="elementsGrid"></div>
                <div class="perspective-box">
                    <div class="perspective-icon">âœ¨</div>
                    <div class="perspective-label">ë‚˜ë§Œì˜ ê´€ì </div>
                    <div class="perspective-text" id="perspectiveText"></div>
                </div>
                <div class="action-area">
                    <button class="retry-btn" onclick="retryAnalysis()">ê°™ì€ ì£¼ì œ ë‹¤ì‹œ ë¶„ì„</button>
                    <button class="new-btn" onclick="newAnalysis()">ìƒˆë¡œìš´ ì£¼ì œ ë¶„ì„í•˜ê¸°</button>
                </div>
            </div>
        </div>

        <footer>
            AI ì‹œëŒ€ ë¯¸ë˜ ì—­ëŸ‰ ê°•ì˜ [ì œ2ê°•] ë¹„íŒì  ì‚¬ê³  <span>|</span> ì •ë³´ì˜ ë°”ë‹¤ì—ì„œ ê´€ì  ì„¸ìš°ê¸°<br>
            ë¶„ì„(Analysis) <span>Â·</span> í‰ê°€(Evaluation) <span>Â·</span> ì¶”ë¡ (Inference) <span>Â·</span> ì„±ì°°(Reflection)
        </footer>
    </div>

    <script>
        const EXAMPLES={
            'SNS ì† ëª¨ë‘ê°€ í–‰ë³µí•´ ë³´ì¸ë‹¤':'SNS ì† ì‚¬ëŒë“¤ì€ ëª¨ë‘ í–‰ë³µí•´ ë³´ì—¬. ë‚˜ë§Œ ë’¤ì²˜ì§€ê³  ë¶ˆí–‰í•œ ê²ƒ ê°™ì•„.',
            'ëª…ë¬¸ëŒ€ë¥¼ ê°€ì•¼ ì„±ê³µí•œë‹¤':'ëª…ë¬¸ëŒ€ì— ê°€ì§€ ëª»í•˜ë©´ ë¯¸ë˜ëŠ” ì‹¤íŒ¨í•œ ê²ƒì´ë‚˜ ë‹¤ë¦„ì—†ë‹¤.',
            'AIê°€ ëª¨ë“  ì§ì—…ì„ ëŒ€ì²´í•  ê²ƒì´ë‹¤':'AIê°€ ë°œì „í•˜ë©´ ëŒ€ë¶€ë¶„ì˜ ì§ì—…ì´ ì‚¬ë¼ì§€ê³ , ì¸ê°„ì€ í•  ì¼ì´ ì—†ì–´ì§ˆ ê²ƒì´ë‹¤.',
            'ì½”ë”© êµìœ¡ì€ í•„ìˆ˜ë‹¤':'ì•ìœ¼ë¡œì˜ ì‹œëŒ€ì—ëŠ” ì½”ë”©ì„ ë°°ìš°ì§€ ì•Šìœ¼ë©´ ë’¤ì²˜ì§ˆ ìˆ˜ë°–ì— ì—†ë‹¤.'
        };

        let lastInput='';
        let loadingInterval;

        function setStep(n){
            document.querySelectorAll('.step').forEach(s=>{
                const sn=+s.dataset.step;
                s.classList.remove('active','done');
                if(sn<n) s.classList.add('done');
                else if(sn===n) s.classList.add('active');
            });
        }

        function setExample(chip){
            const ta=document.getElementById('userInput');
            ta.value=EXAMPLES[chip.textContent]||chip.textContent;
            ta.focus();
        }

        function startLoadingAnimation(){
            let idx=0;
            const steps=document.querySelectorAll('.loading-step');
            steps.forEach(s=>s.classList.remove('active'));
            steps[0].classList.add('active');
            loadingInterval=setInterval(()=>{
                idx=(idx+1)%4;
                steps.forEach(s=>s.classList.remove('active'));
                steps[idx].classList.add('active');
            },1200);
        }

        function stopLoadingAnimation(){
            clearInterval(loadingInterval);
            document.querySelectorAll('.loading-step').forEach(s=>s.classList.add('active'));
        }

        async function analyze(){
            const input=document.getElementById('userInput').value.trim();
            if(!input){showError('ë¶„ì„í•  ì •ë³´ ë˜ëŠ” ìƒí™©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');return;}

            lastInput=input;
            hideError();
            setStep(2);
            document.getElementById('submitBtn').disabled=true;
            document.getElementById('inputSection').style.display='none';
            document.getElementById('submitArea').style.display='none';
            document.getElementById('resultSection').classList.remove('show');
            document.getElementById('loading').classList.add('show');
            startLoadingAnimation();

            try{
                const res=await fetch('/api/analyze',{
                    method:'POST',
                    headers:{'Content-Type':'application/json'},
                    body:JSON.stringify({userInput:input})
                });
                if(!res.ok){
                    const err=await res.json().catch(()=>({}));
                    throw new Error(err.error||'ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
                const data=await res.json();
                stopLoadingAnimation();
                setStep(3);
                renderResult(input,data);
            }catch(err){
                stopLoadingAnimation();
                showError(err.message||'AI ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                setStep(1);
                document.getElementById('inputSection').style.display='';
                document.getElementById('submitArea').style.display='';
            }finally{
                document.getElementById('loading').classList.remove('show');
                document.getElementById('submitBtn').disabled=false;
            }
        }

        function renderResult(input,data){
            document.getElementById('echoText').textContent=input;
            const grid=document.getElementById('elementsGrid');
            grid.innerHTML='';

            const elements=[
                {key:'analysis',num:'ELEMENT 01'},
                {key:'evaluation',num:'ELEMENT 02'},
                {key:'inference',num:'ELEMENT 03'},
                {key:'reflection',num:'ELEMENT 04'}
            ];

            elements.forEach((el,i)=>{
                const d=data[el.key];
                if(!d) return;
                const card=document.createElement('div');
                card.className='element-card';
                card.innerHTML=`
                    <div class="element-header">
                        <div class="element-title">
                            <span class="element-icon">${d.icon}</span>
                            <span class="element-name">${d.title}</span>
                        </div>
                        <span class="element-number">${el.num}</span>
                    </div>
                    <div class="element-question">"${d.question}"</div>
                    <div class="element-content">${d.content}</div>`;
                grid.appendChild(card);
                setTimeout(()=>card.classList.add('visible'),200*i);
            });

            document.getElementById('perspectiveText').textContent=data.myPerspective||'';
            document.getElementById('resultSection').classList.add('show');
            window.scrollTo({top:0,behavior:'smooth'});
        }

        function retryAnalysis(){
            document.getElementById('userInput').value=lastInput;
            document.getElementById('resultSection').classList.remove('show');
            document.getElementById('inputSection').style.display='';
            document.getElementById('submitArea').style.display='';
            setStep(1);
            analyze();
        }

        function newAnalysis(){
            document.getElementById('userInput').value='';
            document.getElementById('resultSection').classList.remove('show');
            document.getElementById('inputSection').style.display='';
            document.getElementById('submitArea').style.display='';
            setStep(1);
            window.scrollTo({top:0,behavior:'smooth'});
        }

        function showError(msg){
            const el=document.getElementById('errorMsg');
            el.textContent=msg;el.classList.add('show');
        }
        function hideError(){document.getElementById('errorMsg').classList.remove('show');}

        document.getElementById('userInput').addEventListener('keydown',e=>{
            if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();analyze();}
        });
    </script>
</body>
</html>
